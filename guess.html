<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>&#127801; Tingles rosiges Rubin-Ratespiel &#127801;</title>
  </head>
  <style>
    html{ /* https://css-pattern.com/shuriken/*/
      --s: 30px;
      --c1: rgb(60,160,80,1);
      --c2: rgb(40,150,70,1);

      --c: var(--c1) 25%,#0000 0;

      --_s:/calc(6*var(--s)) calc(6*var(--s));
      --g1:var(--_s) conic-gradient(from  45deg at     calc(250%/3),var(--c));
      --g2:var(--_s) conic-gradient(from 135deg at 50% calc(250%/3),var(--c));
      --g3:var(--_s) conic-gradient(from 225deg at     calc(50%/3) ,var(--c));
      --g4:var(--_s) conic-gradient(from -45deg at 50% calc(50%/3) ,var(--c));
      background:
        calc(2*var(--s)) calc(5*var(--s)) var(--g4),
        calc(5*var(--s)) calc(2*var(--s)) var(--g4),
        0                calc(4*var(--s)) var(--g3),
        calc(3*var(--s)) var(--s)         var(--g3),
        calc(2*var(--s)) calc(3*var(--s)) var(--g2),
        calc(5*var(--s)) 0                var(--g2),
        var(--s)         var(--s)         var(--g1),
        calc(4*var(--s)) calc(4*var(--s)) var(--g1),
        conic-gradient(at calc(100%/3) calc(200%/3),var(--c))
        0 0/calc(3*var(--s)) calc(3*var(--s)) var(--c2);
    }
    .pximg{
      image-rendering: pixelated;
      image-rendering: -moz-crisp-edges;
    }
    /*:root{ --lowBar: 0; --hiBar: 100; }*/
    .sldB{
      background-color:rgb(0,50,0,1);
      width:16px;
      height:100px;
      color:#FFF;
      border: 2px solid #020;
      border-radius: 8px;
      grid-column:1;
      grid-row:1;
      margin-left: calc(0% - 8px);
      /*animation: a_sldB 2s infinite;*/
    }
    /*@keyframes a_sldB {  0% {margin-left: var(--lowBar);} 100% {margin-left: calc(var(--hiBar)% - 5px);}  }*/
    input{
      text-align: center;
    }
    input:disabled{
      background-color: rgb(255,255,255,0.1);
    }
    body{
      font-family: "Lucida", cursive;
      text-align:center;
      user-select:none;
      -webkit-user-select:none;
      cursor:default;

      /*background-image: linear-gradient(0deg,
          rgb(100,150,100,1) 0%,
          rgb(50,150,30,1) 50%,
          rgb(100,150,100,1) 100%
      );*/
    }
    #barFrm{
      display: flex;
      justify-content: center;
      width:100%;
    }
    #bar0{
      width:800px;
      height:100px;
      display:grid;
      background-image: linear-gradient(0deg,
        rgb(0,0,0,0) 40%,
        rgb(0,50,0,1) 40%,
        rgb(0,100,30,1) 50%,
        rgb(0,50,0,1) 60%,
        rgb(0,0,0,0) 60%
      );
    }
    #slcFrm{
      display: flex;
      justify-content: center;
      width: 100%;
      height: 120px;
    }
    #bgbar{
      display:grid;
      justify-content: center;
      width:700px;
      height:120px;
      background-color:rgb(255,255,255,0.3);
      border-radius: 20px;
    }
    .slcBox{
      width:200px;
      height:30px;
      font-size: 20pt;
      margin: 10px;
      grid-row: 3;
    }
    .slabBox{
      font-size: 20pt;
      grid-row: 2;
      margin-top: 10px;
    }
    #listFrm{
      display: none;
      justify-content: center;
      width: 100%;
      height: 200px;
    }
    #listBox{
      display: flex;
      justify-content: center;
      flex-direction: column;
      width:700px;
      height:200px;
      background-color:rgb(255,255,255,0.3);
      border-radius: 20px;
      overflow: scroll;
    }
    .lsBox{
      text-align: left;
      font-size: 16pt;
      border: 3px solid #FFF;
      border-radius: 10px;
      width:95%;
      margin: 10px;
      padding:5px;
      height:35px;
    }
    .lsBox:hover{
      background-color: rgb(255,255,255,0.2);
      cursor: pointer;
    }
    #spoil{
      background-color: #000;
      padding-left: 10px;
      padding-right: 10px;
    }
    #spoil:hover{
      background-color: rgb(0,0,0,0);
    }
  </style>
  <body>
    <!--<div style="background-color:#0DF;width:40%;font-size:30pt" id="resBtn" onclick="resetF()">RESET</div>-->
    <br>
    <img src="https://cdn.wikimg.net/en/zeldawiki/images/1/1d/TRR_Tingle_2.png" style="width:30px;margin-right:20px">
    <span style="font-size:25pt;font-weight:bold">&#127801; Tingles rosiges Rubin-Ratespiel &#127801;</span>
    <img src="https://cdn.wikimg.net/en/zeldawiki/images/6/65/Tingle_2_TLBT.png" style="width:30px;margin-left:20px">
    <br><br>
    <div id="slcFrm">
      <div id="bgbar">
        <div class="slabBox">Location</div><div class="slabBox">NPC</div><div class="slabBox">Thema</div>
        <input type="text" class="slcBox" id="txt_loc" maxlength="300" onfocus="txFocF()" onkeyup="txLocF()" style="background-color:#FFF"></input>
        <input type="text" class="slcBox" id="txt_npc" maxlength="300" onfocus="txFocF()" onkeyup="txNpcF()" disabled></input>
        <input type="text" class="slcBox" id="txt_req" maxlength="300" onfocus="txFocF()" onkeyup="txReqF()" disabled></input>
      </div>
    </div>
    <br>
    <div id="listFrm">
      <div id="listBox"></div>
    </div>
    <br>

    <div id="barFrm">
      <div style="width:50px;height:50px;background-color:#003200;border-radius:20px;margin-top:25px;margin-right:20px">
        <img src="https://cdn.wikimg.net/en/zeldawiki/images/c/c8/FS_Green_Rupee_Sprite.png" class="pximg" style="width:15px;height:30px;margin-top:10px">
      </div>
      <div id="bar0">
      </div>
      <div style="width:50px;height:50px;background-color:#003200;border-radius:20px;margin-top:25px;margin-left:20px">
        <img src="https://cdn.wikimg.net/en/zeldawiki/images/0/00/TMC_Big_Green_Rupee_Sprite.png" class="pximg" style="width:25px;height:30px;margin-top:10px">
      </div>
    </div>
    <br>
    <span id="rubyDir" style="font-size:20pt"></span>
    <input type="text" style="width:300px;font-size:50pt;margin-top:10px;margin-bottom:10px;" id="num" onkeyup="numF(event)" maxlength="6" disabled></input>
    <br>
    <span id="notif" style="font-size:20pt"></span>
    <br>
    <div id="splFrm" style="font-size:14pt;display:none">Spoiler: <span id="spoil">spoilerspoilerspoiler</span></div>
    <span style="font-family:Courier;font-size:8pt;cursor:pointer;color:#009" onclick="alert('Hier wird README noch großgeschrieben!')">README.md</span>
  </body>
  <script>

    function removeChild(node){node.parentNode.removeChild(node);}

    let markers = [], mkIx = 1, sol=0;
    let mkMin=0,mkMax=0;

    let rawJ = `{"Nahebene":{"Torwächter":[{"req":"Durchgang zur Hafenstadt","price":5,"dirc":"Offer"},{"req":"‹‹Willkommen››","price":5,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Leere Flasche››","price":149,"dirc":"Offer","tag":"Angebot"},{"req":"‹‹Andenken-Flasche››","price":218,"dirc":"Offer","tag":"Angebot"},{"req":"‹‹Grunzer-Story››","price":80,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Frühlingsflasche››","price":381,"dirc":"Offer","tag":"Angebot"},{"req":"‹‹Tolle Flasche››","price":754,"dirc":"Offer","tag":"Angebot"},{"req":"Belohnung: Die Frau des Torwächters heilen","price":960,"dirc":"Ask"},{"req":"Belohnung: Dabei helfen, den Geist vom Frost-Schneefeld zu besiegen","price":20000,"dirc":"Ask"}],"Maître":[{"req":"Seine Küche für Tingle öffnen","price":10,"dirc":"Offer"},{"req":"‹‹Zutatenwissen››","price":10,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Kartoffelwissen››","price":100,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹See-Suppe››","price":3000,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Erd-Suppe››","price":5000,"dirc":"Offer","tag":"Dialog"}],"Krämer":[{"req":"Seinen Laden für Tingle öffnen","price":15,"dirc":"Offer"},{"req":"‹‹Held Zottel››","price":20,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Verkaufe Flasche››","price":50,"dirc":"Offer","tag":"Angebot"},{"req":"‹‹Sage um das Kap››","price":50,"dirc":"Offer","tag":"Dialog"},{"req":"Feilschen um ein Billigmesser","price":210,"dirc":"Ask"},{"req":"Feilschen um einen Billigschild","price":210,"dirc":"Ask"},{"req":"Feilschen um eine Billiglanze","price":230,"dirc":"Ask"},{"req":"Feilschen um a Low-Budget Mace.","price":480,"dirc":"Ask"},{"req":"Feilschen um a Tough Shield","price":520,"dirc":"Ask"},{"req":"Feilschen um einen Schulterschutz","price":2900,"dirc":"Ask"},{"req":"Feilschen um a Destructor Axe","price":3500,"dirc":"Ask"},{"req":"Feilschen um a Poker Lance","price":3500,"dirc":"Ask"},{"req":"Feilschen um a 10-Man Slicer","price":8800,"dirc":"Ask"},{"req":"Feilschen um a 999-Man Slicer","price":15000,"dirc":"Ask"},{"req":"Feilschen um das Zottel-Schwert","price":96000,"dirc":"Ask"}],"Juwelier":[{"req":"Seinen Laden für Tingle öffnen","price":27,"dirc":"Offer"},{"req":"‹‹Weißes Funkeln››","price":25,"dirc":"Offer","tag":"Dialog"},{"req":"Belohnung: Seine Tochter finden","price":4000,"dirc":"Ask"}],"Komachi":[{"req":"Ihr Café für Tingle öffnen","price":36,"dirc":"Offer"},{"req":"‹‹Einen Frischen››","price":35,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Einfacher Saft››","price":150,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Süüüßer Duft››","price":650,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Superedel››","price":2000,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Letzter Schritt››","price":5000,"dirc":"Offer","tag":"Dialog"}],"Chikos Mama":[{"req":"‹‹Elfe››","price":15,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Wahre Liebe››","price":300,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Ewige Liebe››","price":1500,"dirc":"Offer","tag":"Dialog"},{"req":"Kutte machen","price":1750,"dirc":"Offer"},{"req":"‹‹Meine Familie››","price":850,"dirc":"Offer","tag":"Dialog"},{"req":"Belohnung: Die Feenpuppe zurückbringen","price":60,"dirc":"Ask"},{"req":"Feilschen um a Hand-Sewn Robe","price":1750,"dirc":"Ask"},{"req":"Feilschen um a Magical Hat","price":9800,"dirc":"Ask"},{"req":"Belohnung: Chiko eine richtige Elfe sehen lassen","price":32000,"dirc":"Ask"}],"Kellnerin":[{"req":"Den großen Topf kaufen","price":500,"dirc":"Offer"},{"req":"Den Riesentopf kaufen","price":1500,"dirc":"Offer"}],"Tor zum Heldenschrein":[{"req":"Zugang zum Heldenschrein","price":50,"dirc":"Offer"}],"Mimikrikiste (Heldenschrein)":[{"req":"Kiste öffnen","price":50,"dirc":"Offer","misc":"Gibt 200 Rubine"}],"Speckted":[{"req":"Bis zum Ende des Heldenschreins als Leibwächter engagieren","price":20,"dirc":"Offer"},{"req":"Honorar für die Hilfe im Heldenschrein","price":100,"dirc":"Offer"}],"Journalist":[{"req":"‹‹Springbrunnen››","price":185,"dirc":"Offer","tag":"Dialog"}],"Springbrunnen":[{"req":"Belebe die Fee im Springbrunnen wieder","price":20000,"dirc":"Offer"}],"Alter Diener":[{"req":"‹‹Erster Schock››","price":1501,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Zweiter Schock››","price":1625,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Letzter Schock››","price":1751,"dirc":"Offer","tag":"Dialog"},{"req":"Belohnung: Alle von Pauls Sachen wieder auftreiben","price":14000,"dirc":"Ask"}],"Tingles Onkel":[{"req":"Die Credits kaufen","price":10000,"dirc":"Offer"}],"Westliche Quelle":[{"req":"Turm Level 1 + Zugang zur Hamakko-Küste","price":650,"dirc":"Offer"},{"req":"Turm Level 2 + Zugang zum Schatz-Kap","price":1650,"dirc":"Offer"},{"req":"Turm Level 3 + Zugang zur Lon-Lon-Savanne","price":5650,"dirc":"Offer"},{"req":"Turm Level 4 + Zugang zum Deku-Wald","price":11650,"dirc":"Offer"},{"req":"Turm Level 5 + Zugang zum Feuchtgebiet","price":29650,"dirc":"Offer"},{"req":"Turm Level 6 + Zugang zum Drumpf-Sumpf","price":56650,"dirc":"Offer"},{"req":"Turm Level 7 + Zugang zum Frost-Schneefeld","price":110650,"dirc":"Offer"},{"req":"Turm Level 8 + Zugang zum Todesberg","price":191650,"dirc":"Offer"},{"req":"Turm Level 9 + Zugang zum Elfengarten","price":313150,"dirc":"Offer"},{"req":"Turm Level 10 + Zugang zur Allerletzten Ruine","price":495400,"dirc":"Offer"}]},"Hamakko-Küste":{"Duke":[{"req":"Die Brücke zwischen der Nahebene und der Hamakko-Küste reparieren","price":99,"dirc":"Offer"},{"req":"Bridge repair refund","price":9999,"dirc":"Ask"}],"Dusty":[{"req":"Bridge repair refund","price":22222,"dirc":"Ask"}],"Duko":[{"req":"Bridge repair refund","price":55555,"dirc":"Ask"}],"Leibwächter-Saloon":[{"req":"Winzo (Schulkind)","price":45,"dirc":"Offer","misc":"Klein, Aggressiv, HP:4, Att:3, Def:3"},{"req":"Chuckles (Clown)","price":105,"dirc":"Offer","misc":"Medium, Passiv, HP:5, Att:4, Def:5"},{"req":"Soma (Schwert-Expertin)","price":125,"dirc":"Offer","misc":"Medium, Aggressiv, HP:5, Att:4, Def:5"},{"req":"[Frei] Speckted","price":9500,"dirc":"Offer","misc":"Groß, Aggressiv, HP:20, Att:20, Def:19, 5000 Rubine beim ersten Mal"},{"req":"[Frei] Gecko (Ninja)","price":9000,"dirc":"Offer","misc":"?, Bestimmt, HP:19, Att:20, Def:20"}]},"Schatz-Kap":{"Duke":[{"req":"Die Brücke zwischen der Hamakko-Küste und dem Schatz-Kap reparieren","price":199,"dirc":"Offer"}],"Salooner":[{"req":"Rezept #9 kaufen","price":1200,"dirc":"Offer","misc":"Schatz-Püree (Lokales Rezept)"}],"Tor zum Versteck der Piraten":[{"req":"Zugang zum Versteck der Piraten","price":500,"dirc":"Offer"}],"Pirat beim Boot":[{"req":"Explain boat mechanics","price":30,"dirc":"Offer"}],"Pirat im Schlafbereich":[{"req":"Nichts","price":20,"dirc":"Offer"}],"Journalist":[{"req":"Belohnung: Einen Einfachen Saft geben","price":800,"dirc":"Ask"}]},"Lon-Lon-Savanne":{"Duke":[{"req":"Schaufel kaufen","price":750,"dirc":"Offer"},{"req":"Die Brücke zwischen dem Schatz-Kap und der Lon-Lon-Savanne reparieren","price":299,"dirc":"Offer"}]},"Deku-Wald":{"Liano":[{"req":"Brücke über das Tal","price":300,"dirc":"Offer"},{"req":"Weg durch den Irrwald zeigen","price":721,"dirc":"Offer","misc":"Alternativ: ↑ ← ← ↑ ← ↑ → → ↓ → ↑ → ↑"},{"req":"‹‹Schlaflose Nächte››","price":850,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Topfit››","price":900,"dirc":"Offer","tag":"Dialog"},{"req":"‹‹Im Irrwald...›› (Leere Flasche)","price":1900,"dirc":"Offer","tag":"Dialog"},{"req":"Belohnung: Eskorte nach Hause","price":2000,"dirc":"Ask"},{"req":"Belohnung: Aba und den Krämer wieder vereinen","price":7800,"dirc":"Ask"}],"Duke":[{"req":"Die Brücke zwischen Lon-Lon-Savanne und Deku-Wald reparieren","price":699,"dirc":"Offer"}],"Deku-Baum":[{"req":"Den Eingang zum Baum öffnen","price":1,"dirc":"Offer","misc":"Rubine werden in der grünen Kiste im Deku-Tempel gelagert"},{"req":"Belohnung: Den kleinen Deku-Baum heilen","price":6000,"dirc":"Ask"}],"Tor zum Deku-Tempel":[{"req":"Zugang zum Deku-Tempel","price":1500,"dirc":"Offer"}],"Mimikrikiste (Deku-Tempel)":[{"req":"Kiste öffnen","price":200,"dirc":"Offer","misc":"Gibt 3 Alte Münzen (Wert: 50 Rubine pro Stück)"}],"Journalist":[{"req":"Belohnung: Einen Süßen Saft geben","price":1600,"dirc":"Ask"}]},"Feuchtgebiet":{"Vespenkönigin":[{"req":"Fahrtkosten zum Insekten-Nest im Drumpf-Sumpf","price":500,"dirc":"Offer"},{"req":"Belohnung: Den Nebel beseitigen (Königin heilen)","price":12000,"dirc":"Ask"}],"Salooner":[{"req":"Leere Flasche kaufen","price":750,"dirc":"Offer"}],"Leibwächter-Saloon":[{"req":"Dickago (Baseball-Schläger-Typ)","price":1300,"dirc":"Offer","misc":"Groß, Aggressiv, HP:14, Att:13, Def:13"},{"req":"[Frei] Gecko (Ninja)","price":9000,"dirc":"Offer","misc":"?, Bestimmt, HP:19, Att:20, Def:20"}]},"Drumpf-Sumpf":{"Sekretär der Expedition":[{"req":"Leere Flasche kaufen","price":1000,"dirc":"Offer"}],"Ärztin der Expedition":[{"req":"Rezept #17 kaufen","price":2000,"dirc":"Offer","misc":"Tinkelin"}],"Expeditions-Mitglied mit Fächer":[{"req":"Information on butterfly locations ('something good')","price":250,"dirc":"Offer"}],"Salooner":[{"req":"‹‹Flugkörper???››","price":1000,"dirc":"Offer","tag":"Dialog"}],"Dusty":[{"req":"Die Brücke zum Obelisk reparieren","price":1500,"dirc":"Offer"},{"req":"Die Brücke zwischen Drumpf-Sumpf und Feuchtgebiet reparieren","price":1222,"dirc":"Offer"}],"Tor zur Krabbelhöhle":[{"req":"Zugang zur Krabbelhöhle","price":3000,"dirc":"Offer"}],"Speckted":[{"req":"Honorar für die Hilfe in der Krabbelhöhle","price":1500,"dirc":"Offer"}],"Journalist":[{"req":"Belohnung: Einen Königinnen-Saft geben","price":5000,"dirc":"Ask"}],"Zweiter Salooner (nackt)":[{"req":"Belohnung: Die grüne Kutte geben","price":8000,"dirc":"Ask"}]},"Frost-Schneefeld":{"Dusty":[{"req":"Die Brücke zwischen dem Frost-Schneefeld und dem Drumpf-Sumpf reparieren","price":2222,"dirc":"Offer"}],"Chikos Großmutter":[{"req":"Den Torwächter wiederbeleben","price":1000,"dirc":"Offer"}],"Alter Diener":[{"req":"Belohnung: Alle fünf Teile zurückbringen","price":22000,"dirc":"Ask"}]},"Todesberg":{"Male Yamatami villager":[{"req":"To be greeted (before clearing Desma's Labyrinth)","price":50,"dirc":"Offer"}],"Sleeping Yamatami villager":[{"req":"Listen to snoring (before clearing Desma's Labyrinth)","price":50,"dirc":"Offer"}],"Yamatami elder":[{"req":"Talk about sacred flames (before clearing Desma's Labyrinth)","price":50,"dirc":"Offer"}],"Yamatami bard":[{"req":"Hear a song (before clearing Desma's Labyrinth)","price":200,"dirc":"Offer"}],"Female Yamatami villager":[{"req":"To access Rocky Orb (before clearing Desma's Labyrinth)","price":400,"dirc":"Offer"}],"Yamatami meat merchant":[{"req":"Purchase Minced Meat (before clearing Desma's Labyrinth)","price":150,"dirc":"Offer"},{"req":"Purchase Minced Meat (after clearing Desma's Labyrinth)","price":10,"dirc":"Offer"}],"Yamatami vegetable merchant":[{"req":"Purchase Crisp Tomato (before clearing Desma's Labyrinth)","price":150,"dirc":"Offer"},{"req":"Purchase Crisp Tomato (after clearing Desma's Labyrinth)","price":10,"dirc":"Offer"}],"Yamatami fish merchant":[{"req":"Purchase Love Carp (before clearing Desma's Labyrinth)","price":150,"dirc":"Offer"},{"req":"Purchase Love Carp (after clearing Desma's Labyrinth)","price":10,"dirc":"Offer"}],"Yamatami farmer":[{"req":"To access Super Sweetcorn vines","price":150,"dirc":"Offer"}],"Yamatami herder":[{"req":"To access rabbit pen","price":500,"dirc":"Offer"}],"Yamatami mother":[{"req":"Purchase Recipe #28: Desma Syrup","price":16000,"dirc":"Offer"}],"King":[{"req":"Heal the king","price":7500,"dirc":"Offer"},{"req":"Belohnung: defeating Fire Monster Dora Dora","price":30000,"dirc":"Ask"},{"req":"Feilschen um 1 Nidorian","price":170,"dirc":"Ask"}],"Desma's Labyrinth Gate":[{"req":"Allow access to Desma's Labyrinth","price":8000,"dirc":"Offer"}],"Journalist":[{"req":"Bring Emperor Juice","price":10000,"dirc":"Ask"}]},"Elfengarten":{"Duko":[{"req":"Repair Auros Ruins-to-Fairy Garden bridge","price":5555,"dirc":"Offer"}],"Große Fee":[{"req":"Belohnung: restoring her fountain","price":65000,"dirc":"Ask"},{"req":"Return the Make-Up Mirror","price":70000,"dirc":"Ask"}]},"Allerletzte Ruine":{"Duko":[{"req":"Repair Auros Ruins-to-Fairy Garden bridge","price":15555,"dirc":"Offer"}],"Oinker Lovers":[{"req":"Return the Oinker Tiara","price":70000,"dirc":"Ask"}]}}`;

    var jData = JSON.parse(rawJ);
    console.log(jData);
    sel_loc="",sel_npc="",sel_req="",sel_dirc="",sel_misc="";

    let tmpNPCs = ["Armorer","Jeweller","Guard","Chiko's Mum","Duke","Salona","Pirate Hideaway Gate","Junglo"];

    let tmpReqs = ['Talk: "Sleepless Nights"','Repair the bridge between Lon Lon Meadow and Deku Forest','Reward for giving him Sweet Juice',
      'Ride to Insect Hive in Gooey Swamp','Information on butterfly locations ("something good")','Share for helping in the Insect Cavern']

    window.onkeydown = function(e){if(e.key=="Enter" && document.activeElement.id=="num"){

        let nval = document.getElementById("num").value;
        if(nval==0){addMkF(1);}
        else if(!isNaN(nval)){addMkF(parseInt(nval));}
        document.getElementById("num").value = "";
    }}

    function txFocF(){
      document.getElementById('listFrm').style.display = "flex";
      document.getElementById("rubyDir").innerHTML = "";
      document.getElementById("notif").innerHTML = "";
      document.getElementById("splFrm").style.display = "none";
    }

    function txLocF(){
      let txval = document.getElementById('txt_loc').value.toUpperCase();

      document.getElementById("bar0").innerHTML = "";
      document.getElementById('num').value = "";
      document.getElementById('num').setAttribute("disabled",true);

      document.getElementById('txt_npc').value = "";
      document.getElementById('txt_npc').setAttribute("disabled",true);

      document.getElementById('txt_req').value = "";
      document.getElementById('txt_req').setAttribute("disabled",true);

      document.getElementById('listBox').innerHTML = "<br>";
      document.getElementById('listBox').scrollTop = 0;


      if(txval.length>2){for(key in jData) {

        if(key.toUpperCase().indexOf(txval)>-1){
            let lsB = document.createElement("div");
            lsB.id = "loc_"+key;
            lsB.classList.add("lsBox");
            lsB.innerHTML = key;
            document.getElementById('listBox').appendChild(lsB);
        }
      }}
      document.getElementById('listBox').innerHTML += "<br>";
      let evtApplX = document.getElementById('listBox').children; // Hotfix, weil sich Events in der Schleife nicht direkt zuweisen ließen
      for(var chl of evtApplX){ if(chl.id.indexOf("loc_")>-1){  chl.onclick = function(e){prepNpcF(e.target.innerHTML);}  } }

    }
    function prepNpcF(loc){
      document.getElementById('txt_loc').value = loc;
      sel_loc = loc;
      document.getElementById('txt_npc').removeAttribute("disabled");
      if(document.getElementById('txt_npc').value=="") document.getElementById('txt_npc').focus();
      document.getElementById('listBox').innerHTML = "<br>";
      document.getElementById('listBox').scrollTop = 0;
    }

    function txNpcF(){
      let txval = document.getElementById('txt_npc').value.toUpperCase();

      document.getElementById("bar0").innerHTML = "";
      document.getElementById('num').value = "";
      document.getElementById('num').setAttribute("disabled",true);

      document.getElementById('listBox').innerHTML = "<br>";
      document.getElementById('listBox').scrollTop = 0;

      document.getElementById('txt_req').value = "";
      document.getElementById('txt_req').setAttribute("disabled",true);

      if(txval.length>2){for(key in jData[sel_loc]){

        if(key.toUpperCase().indexOf(txval)>-1){
            let lsB = document.createElement("div");
            lsB.id = "npc_"+key;
            lsB.classList.add("lsBox");
            lsB.innerHTML = key;
            document.getElementById('listBox').appendChild(lsB);
        }
      }}
      document.getElementById('listBox').innerHTML += "<br>";
      let evtApplX = document.getElementById('listBox').children; // Hotfix, weil sich Events in der Schleife nicht direkt zuweisen ließen
      for(var chl of evtApplX){ if(chl.id.indexOf("npc_")>-1){  chl.onclick = function(e){prepReqF(e.target.innerHTML);}  } }
    }
    function prepReqF(npc){
      document.getElementById('txt_npc').value = npc;
      sel_npc = npc;
      document.getElementById('txt_req').removeAttribute("disabled");
      if(document.getElementById('txt_req').value=="") document.getElementById('txt_req').focus();
      document.getElementById('listBox').innerHTML = "<br>";
      document.getElementById('listBox').scrollTop = 0;
    }

    function txReqF(){
      let txval = document.getElementById('txt_req').value.toUpperCase();

      document.getElementById("bar0").innerHTML = "";
      document.getElementById('num').value = "";
      document.getElementById('num').setAttribute("disabled",true);

      document.getElementById('listBox').innerHTML = "<br>";
      document.getElementById('listBox').scrollTop = 0;

      let npc_tasks = jData[sel_loc][sel_npc].length;
      if(txval.length>2){for(var key=0;key<npc_tasks;key++){

        let sel_task = jData[sel_loc][sel_npc][key];

        if(sel_task.req.toUpperCase().indexOf(txval)>-1){
            let lsB = document.createElement("div");
            lsB.id = "req_"+sel_npc+"_"+key;
            lsB.classList.add("lsBox");
            lsB.setAttribute("data-direction",sel_task.dirc);
            lsB.innerHTML = sel_task.req;
            document.getElementById('listBox').appendChild(lsB);
        }
      }}
      document.getElementById('listBox').innerHTML += "<br>";
      let evtApplX = document.getElementById('listBox').children; // Hotfix, weil sich Events in der Schleife nicht direkt zuweisen ließen
      for(var chl of evtApplX){ if(chl.id.indexOf("req_")>-1){  chl.onclick = function(e){prepGuessF(e.target.innerHTML);}  } }
    }
    function prepGuessF(req,dirc){
      document.getElementById('txt_req').value = req;
      sel_req = req;
      let sel_task = jData[sel_loc][sel_npc];
      for(var i=0;i<sel_task.length;i++) if(req==sel_task[i].req){
        sol = sel_task[i].price;
        sel_dirc = sel_task[i].dirc;
        sel_misc = sel_task[i].misc;
      }
      document.getElementById('listBox').innerHTML = "<br>";
      document.getElementById('listBox').scrollTop = 0;
      resetF();
    }

    function resetF(){
      document.getElementById("listFrm").style.display = "none";
      document.getElementById("bar0").innerHTML = "";
      document.getElementById("rubyDir").innerHTML = `${sel_dirc=="Offer" ? "Rubine anbieten:" : "Rubine fordern:"}<br>`;
      document.getElementById("notif").innerHTML = "Bisher 0 Versuche";
      console.log(sel_misc);
      if(!(typeof sel_misc=="undefined")){
        document.getElementById("spoil").innerHTML = sel_misc;
        document.getElementById("splFrm").style.display = "block";
      }

      let rup = document.createElement("div");
      rup.id = "mk0";
      rup.classList.add("sldB");
      rup.style['margin-left'] = "calc(50% - 8px)";
      //rup.innerHTML = "?";
      rup.value = sol;
      let rupImg = document.createElement("img");
      rupImg.src = "https://cdn.wikimg.net/en/zeldawiki/images/8/85/FPTRR_DS_Game_Icon.png";
      rupImg.style.width = "32px";
      rupImg.style['margin-left'] = "-8px";
      //rupImg.height = "16px";
      rup.appendChild(rupImg);
      document.getElementById("bar0").appendChild(rup);

      markers = [sol];
      mkIx = 1;
      document.getElementById("num").removeAttribute("disabled");
    }

    function addMkF(val){
      if(sol==val){
        document.getElementById("mk0").style['background-color'] = "rgb(255,200,30,1)";
        //window.alert("I WON!");
        document.getElementById("notif").innerHTML = `RICHTIG! Es sind ${sol} Rubine!`
      }else{
        markers.push(val);

        let digs = val.toString().length;

        let mkV = document.createElement("div");
        mkV.id = "mk"+mkIx; mkIx++;
        mkV.classList.add("sldB");
        mkV.style.height = "70px";
        mkV.style['margin-left'] = `calc(0% - 5px)`;
        mkV.style['margin-top'] = "15px";
        mkV.style['writing-mode'] = "vertical-lr";
        mkV.style['font-size'] = "8pt";
        mkV.innerHTML = val;
        mkV.title = val;
        mkV.value = val;
        document.getElementById("bar0").appendChild(mkV);

        let tmpMK0 = document.getElementById("mk0");
        removeChild(document.getElementById("mk0"));
        document.getElementById("bar0").appendChild(tmpMK0);

        document.getElementById("notif").innerHTML = `Bisher ${mkIx-1} Versuch(e)!`;
        updLocF();

      }
    }
    function updLocF(){

      mkMin = Math.log(Math.min.apply(Math,markers));
      mkMax = Math.log(Math.max.apply(Math,markers));

      let barCol = document.getElementById("bar0").children;

      for(var mk of barCol){

        let relPos = mk.value==0 ? 0: (Math.log(mk.value)-mkMin)/(mkMax-mkMin);
        if(mkMin==mkMax) relPos = 50;
        document.getElementById(mk.id).style['margin-left'] = `calc(${800*relPos-8}px)`;// `calc(${relPos}% - ${5}px)`;
        //document.documentElement.style.setProperty('--lowBar',mk.style['margin-left']);
        //document.documentElement.style.setProperty('--hiBar',`${relPos}`);
        //console.log(relPos,mk,mkMax,mkMin);
      }


    }

    function numF(e){
      let nval = document.getElementById('num').value;
      if(isNaN(parseInt(nval)) || nval=="NaN" || nval==NaN || nval==""){  document.getElementById('num').value = "";  }
      else{
        document.getElementById('num').value = parseInt(nval);
        if(!isNaN(parseInt(nval))) if(parseInt(nval)<0) document.getElementById('num').value = Math.abs(nval);
      }
    }

  </script>
</html>
